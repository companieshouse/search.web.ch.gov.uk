{% extends "base.html" %}

{% block pageTitle %}
    {% if errorList.length > 0 %}
        Error:
    {% endif %}
        Search results - Advanced company search - Find and update company information - GOV.UK
{% endblock %}

{% block beforeContent %}

  {{ govukBackLink({
  text: "Back to Companies House service",
  href: "/"
  }) }}
{% endblock %}

{% block content %}

  {% if errorList.length > 0 %}
    {{ govukErrorSummary({
      titleText: ERROR_SUMMARY_TITLE,
      errorList: errorList
    }) }}
  {% endif %}
  
  {% set companyFormHtml %}      
    <fieldset class='govuk-fieldset'>

      <div class='govuk-form-group'>  
        <label class='accordion-label' for='companyNameIncludes'>
          Company names that contain
        </label>
        <input class='govuk-input govuk-!-width-width-full' id='companyNameIncludes' name='companyNameIncludes' type='text' value='{{ companyNameIncludes }}'>
      </div>

      <hr class='govuk-section-break govuk-section-break--m govuk-section-break--visible'>

      <div class='govuk-form-group'>
        <label class='accordion-label' for='companyNameExcludes'>
          Exclude company names that contain
        </label>
        <input class='govuk-input govuk-!-width-width-full' id='companyNameExcludes' name='companyNameExcludes' type='text' value='{{ companyNameExcludes }}'>
      </div>

    </fieldset>          
  {% endset %}

  {% set roaFormHtml %}      
    <div class="govuk-form-group">  
      <label class="accordion-label" for="registeredOfficeAddress">
        Enter a full or partial address
      </label>
      <input class='govuk-input govuk-!-width-width-full' id='registeredOfficeAddress' name='registeredOfficeAddress' type='text' value='{{ location }}'>
    </div>         
  {% endset %}

  {% set incorporationDateHmtl %}
    {% if errorList.length > 0 %}
      {% if incorporatedFromError %}
        <div class='govuk-form-group govuk-form-group--error'>  
          <label class='accordion-label' for='incorporatedFrom'>
            Companies incorporated after
          </label>
          <div id='incorporation-date-from-hint' class='accordion-hint'>
              For example, 27/03/2007
          </div>
            <span id="incorporatedFrom-error" class="govuk-error-message">
              <span class="govuk-visually-hidden">Error:</span> {{ incorporatedFromError.text }}
            </span>
          <input class='govuk-input govuk-!-width-width-full govuk-input--error' id='incorporatedFrom' name='incorporatedFrom' type='text' value='{{ incorporatedFrom }}' aria-describedby='incorporatedFrom-error'>
        </div>
      {% else %}
        <div class='govuk-form-group'>  
          <label class='accordion-label' for='incorporatedFrom'>
            Companies incorporated after
          </label>
          <div id='incorporation-date-from-hint' class='accordion-hint'>
              For example, 27/03/2007
          </div>
          <input class='govuk-input govuk-!-width-width-full' id='incorporatedFrom' name='incorporatedFrom' type='text' value='{{ incorporatedFrom }}'>
        </div>
      {% endif %}

      <hr class='govuk-section-break govuk-section-break--m govuk-section-break--visible'>

      {% if incorporatedToError %}
        <div class='govuk-form-group govuk-form-group--error'>  
          <label class='accordion-label' for='incorporatedTo'>
            Companies incorporated before
          </label>
          <div id='incorporation-date-to-hint' class='accordion-hint'>
              For example, 27/03/2007
          </div>
            <span id="incorporatedTo-error" class="govuk-error-message">
              <span class="govuk-visually-hidden">Error:</span> {{ incorporatedToError.text }}
            </span>
          <input class='govuk-input govuk-!-width-width-full govuk-input--error' id='incorporatedTo' name='incorporatedTo' type='text' value='{{ incorporatedTo }}' aria-describedby='incorporatedTo-error'>
        </div>
      {% else %}
        <div class='govuk-form-group'>
          <label class='accordion-label' for='incorporatedTo'>
            Companies incorporated before
          </label>
          <div id='incorporation-date-to-hint' class='accordion-hint'>
              For example, 27/03/2007
          </div>
          <input class='govuk-input govuk-!-width-width-full' id='incorporatedTo' name='incorporatedTo' type='text' value='{{ incorporatedTo }}'>
        </div>
      {% endif %}
    {% else %}
      <div class='govuk-form-group'>  
        <label class='accordion-label' for='incorporatedFrom'>
          Companies incorporated after
        </label>
        <div id='incorporation-date-from-hint' class='accordion-hint'>
            For example, 27/03/2007
        </div>
        <input class='govuk-input govuk-!-width-width-full' id='incorporatedFrom' name='incorporatedFrom' type='text' value='{{ incorporatedFrom }}'>
      </div>

      <hr class='govuk-section-break govuk-section-break--m govuk-section-break--visible'>

      <div class='govuk-form-group'>
        <label class='accordion-label' for='incorporatedTo'>
          Companies incorporated before
        </label>
        <div id='incorporation-date-to-hint' class='accordion-hint'>
            For example, 27/03/2007
        </div>
        <input class='govuk-input govuk-!-width-width-full' id='incorporatedTo' name='incorporatedTo' type='text' value='{{ incorporatedTo }}'>
      </div>
    {% endif %}
  {% endset %}

<div class="govuk-width-container">

  <div class="govuk-grid-row">

    <div class="govuk-grid-column-full">

        <h1 class="govuk-heading-l">Advanced company search</h1>

        <p class="govuk-body">Fill in one or more fields to search the Companies House register.</p>

    </div>
  </div>


  <div class="govuk-grid-row">

    <div class="govuk-grid-column-one-third" style="margin-right: 15px;">

      <form action="/advanced-search/get-results" method="GET">

        <div class="govuk-button-group">
            <button class="govuk-button" data-module="govuk-button">
              Update results
            </button>
            <input type="button" class="govuk-button govuk-button--secondary" value="Clear search" onclick="clearForm(this.form)"></input>
        </div>

        {{ govukAccordion({
          id: "accordion-default",

          items: [
            {
              heading: {
                text: "Company name"
              },
              content: {
                html: companyFormHtml
              }
            },
             {
              heading: {
                text: "Registered office address"
              },
              content: {
                html: roaFormHtml
              }
            },
            {
              heading: {
                text: "Incorporation date"
              },
              content: {
                html: incorporationDateHmtl
              }
            }
          ]
        }) }}
        
        <div class="govuk-button-group">
            <button class="govuk-button" data-module="govuk-button">
              Update results
            </button>
            <input type="button" class="govuk-button govuk-button--secondary" value="Clear search" onclick="clearForm(this.form)"></input>
        </div>
      </form>

    </div>

    <div class="govuk-grid-two-thirds two-thirds-div" style="padding-top: 45px;">
      <div>
        {% if searchResults.length > 0 %}
          {{ govukTable ({
              rows: searchResults,
              classes: 'govuk-!-font-size-16 govuk-!-width-one-half'
          }) }}

          {% if numberOfPages > 1 %}
              {% include "../components/pagination.html" %}
          {% endif %}

          <p class="govuk-body">{{ ADVANCED_SEARCH_LAST_UPDATED }}</p>  
        {% else %}
          <h2 class="govuk-heading-l" style="overflow-wrap: break-word;">No results found</h2>
          <p class="govuk-body">Please try searching again using a different search criteria.</p>
        {% endif %}
      </div>
    </div>
  </div>   
</div>
{% endblock %}